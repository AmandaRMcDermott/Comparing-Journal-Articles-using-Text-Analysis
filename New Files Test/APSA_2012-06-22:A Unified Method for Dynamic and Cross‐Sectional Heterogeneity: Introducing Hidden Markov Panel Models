"","x"
"1","In this section, I present a unified framework to test and model time‐varying unobserved heterogeneity. The approach proposed in this article has a unified framework in the sense that all the statistical methods here are based on the common framework of Bayesian HMM analysis. Also, my two statistical models for time‐varying heterogeneity, corresponding to fixed‐effects models and random‐effects models, share the same HMM framework.         "
"2","HMM is a well‐known statistical approach to modeling level shifts or variance changes in a time‐series process.3 The essential part of HMM is the assumption of conditional independence: the distribution of data, conditional upon hidden states, is independent. Thus, once I know the hidden states, the statistical inference for regression parameters is the same as conventional regression models. Then, the essential question in HMM analysis is how to identify the number, timing, and type of hidden regimes.         "
"3","Among many methods for the hidden‐state inference, Chib’s (1998) nonergodic HMM (or multiple change‐point model) has several advantages for social science data.4 First, history in the social sciences is generally considered as a nonrecurrent process full of discontinuities (Abbott 2001; Lieberman 2001; Sewell 2005). Thus, the nonergodic assumption of regime transitions in Chib’s (1998) method is consistent with the general understanding of regime changes in social history. Second, the nonergodic transition matrix makes it easy to identify multiple hidden states by simplifying the initial probability of hidden states and by labeling regime‐specific parameters in a nonreversible way. Last, the nonergodic transition matrix can be used to model both recurrent and nonrecurrent regime transitions as no constraint is imposed on parameters of nonadjacent states (e.g., state 1 and state 3). Thus, a regime‐switching process can be identified by comparing parameters of nonadjacent states after model fitting.         "
"4","In this section, I present two tests to diagnose changes in unobserved factors (or individual effects) in linear panel data models: a test for group‐level breaks and a test for subject‐specific breaks. The purpose of the tests is to check for the existence of changes in unobserved factors from panel residuals. If unobserved factors are time constant, residuals should not show any systematic change over time and across subjects."
"5","The statistical technique for the tests is Bayesian model comparison using marginal likelihoods. In Bayesian model comparison, the marginal likelihood of model k, p(y|k), corresponds to the probability of observing the data (y) given the model under consideration (k). The posterior probability of break number k can be computed as a ratio of the sum of all candidate HMMs’ marginal likelihoods, holding a parametric model  constant. Let K be an upper threshold for break numbers. Then, the posterior probability of break number k is               "
"6","Among many computational approaches that have been proposed to compute marginal likelihoods (Chib 1995; Chib and Jeliazkov 2001; Geweke 1989; Green 1995; Kass and Raftery 1995; Meng and Wong 1996; Newton and Raftery 1994), I use Chib’s (1995) algorithm to compute marginal likelihoods from Gibbs sampling outputs because of its computational advantages.6"
"7","In the following, I present a test for group‐level breaks using multivariate residuals at the group level and a test for subject‐specific breaks using univariate residuals at the subject level."
"8","               "
"9","Fit a linear Gaussian multivariate HMM with M number of breaks using N (the number of subjects)  vector of panel residuals :                        "
"10","Compute the marginal likelihood of the M‐component HMM.                     "
"11","Repeat all steps by varying M from 0 to an upper bound of break number (K).                     "
"12","Compute the posterior model probability for , "
"13","Similarly, subject‐specific breaks can be detected by applying a linear Gaussian HMM to subject‐specific residuals from panel data models."
"14","               "
"15","Fit a linear Gaussian univariate HMM with Mi number of breaks using a residual of a panel data model for subject i :                        "
"16","Compute the marginal likelihood of the Mi‐component HMM.                     "
"17","Repeat the above step by varying Mi from 0 to an upper bound of break number (Ki).                     "
"18","Compute the posterior model probability for , .                     "
"19","Repeat all steps for "
"20","As researchers do not have clear knowledge about whether regime changes are experienced in common or are different for each individual subject, it is important to visually inspect temporal patterns of panel residuals before tests."
"21","When hidden breaks exist in panel residuals, researchers need to respecify their statistical models to account for these hidden changes. In this section, I introduce two panel HMMs focusing on two canonical panel data methods: the random‐effects model and the fixed‐effects model. A general form for a panel data model can be written following Laird and Ware's (1982) notation in which yit denotes an observation for subject i at t, xit is the  vector of regressors, wit is the  vector of the random‐effects regressors, which is a subset of xit, and bi is the  random‐effects coefficient vector with variance‐covariance matrix D:            "
"22","The first panel HMM I propose is the random‐effects HMM in which all subjects in the panel data are assumed to be exposed to a similar type of unknown system‐level shocks. The model can be written as a mixture of M random‐effects panel models sequentially applied to M time blocks as follows:            "
"23","In the random‐effects HMM, regime changes in unobserved factors are considered as systematic features of data, not as noise, that should be included in statistical inference. Thus, all regression parameters are interacted with changes in hidden regimes. In this sense, the random‐effects HMM is similar to the regression model in which all predictors are interacted with dummy variables of hidden regimes. However, two major differences still exist between them. One is that unlike the dummy‐variable method, the random‐effects HMM does not require the prior knowledge of the number and timing of hidden regimes. Another difference is that the random‐effects HMM allows effects of regime transitions to vary across subjects, which will be estimated by bi and Dm.8"
"24","The second panel HMM is the fixed‐effects HMM in which subjects are assumed to be exposed to subject‐specific shocks. The model can be succinctly written in matrix form as follows:             "
"25","Unlike the random‐effects HMM, the fixed‐effects HMM considers regime changes in individual effects as a nuisance that inhibits statistical inference of slope parameters (). The constant fixed‐effects model is a special case of the fixed‐effects HMM where the number of a hidden regime is 1 for all i: that is,  and  for all i and t. Only in that special (and potentially rare) case does the fixed‐effects model provide a consistent estimate of .9"
"26","Before applying my methods to real‐world examples, I will evaluate the performance of the methods using simulated data. First, I generate multiple panel data sets with one break to test the performance of the random‐effects HMM. The cross‐sectional sample size (N) starts at 10 and increases by 10 to 40. The time‐series sample size (T) starts at 20 and increases by 20 to 100. I set the timing of breaks in the middle of the sample.10"
"27","I compare the RMSEs of the random‐effects HMM with the RMSEs of the constant random‐effects model: the results of this comparison are reported in Table 1.11 Overall, the RMSEs from the constant random‐effects models (top) are always larger than the RMSEs from the random‐effects HMM regardless of the number of subjects (N) and the length of time‐series observation (T). The gaps in the performance become larger with more data over time and across subjects.            "
"28","The data for the simulation study of the fixed‐effects HMM are similarly generated from the above except for the fact that the number of subjects without regime changes (N0 in Table 2) vary in the simulation. That is, I allow only a portion of panel subjects to be exposed to individual shocks to see how it affects the estimation of slope parameters. Unobserved factors are generated from a Normal distribution with a large variance. I fixed the cross‐sectional sample size at 40 while varying the size of time‐series observations from 40 to 100.            "
"29","Table 2 compares the performance of different fixed‐effects models based on their RMSEs. The true value of the slope is 1 in the simulation. The top line represents the ideal case in the dummy variable regression to control for effects of time‐varying individual effects: researchers use the correct knowledge of the number and timing of subject‐specific regime transitions. I use this best estimate from the OLS with dummy variables as a benchmark for the performance of the fixed‐effects HMMs.            "
"30","The results in the middle of Table 2 are from the fixed‐effects HMM using the result of the subject‐level residual break test as an input for break numbers. In this analysis, the number and timings of breaks are considered as unknown quantities that need to be estimated from data. It is impressive to see that the fixed‐effects HMM using the result of the subject‐level residual break test outperforms the OLS with subject and regime dummy variables in terms of RMSE.            "
"31","One interesting fact I found from the simulation study of the fixed‐effects HMM is that the subject‐level residual break test sometimes overidentifies subject‐level break numbers. As long as regime changes are nondeterministic, identifying the true numbers of breaks in a nuisance parameter does not make much sense, but it is important to check whether the estimation of slopes is sensitive to the overfitting problem. The bottom of Table 2 shows the results of the fixed‐effects HMM that uses the true break numbers as an input. The comparison of RMSE between the two fixed‐effects HMMs in the middle and bottom indicates that the prior specification of true break numbers does not necessarily improve the precision of slope estimates in the fixed‐effects HMM.12"
"32","Nearly six decades ago, Kuznets (1955) observed that inequality increases and subsequently falls during the process of industrialization. Since then, many political economists have investigated the inverse U‐shaped relationship between inequality and development (Acemoglu and Robinson 2000; Aghion, Caroli, and Garcia‐Penalosa 1999; Alberto and Rodrik 1994; Boix 2003; Perotti 1996; Persson and Tabellini 1994). For example, Li and Zou (1998) find that inequality has a positive effect for economic growth, while Alberto and Rodrik (1994), Persson and Tabellini (1994), and Perotti (1996) find the opposite effect. Using a cross‐national data set, Barro (2000) finds weak support for the Kuznets hypothesis, but reports that a large portion of the data remains unexplained.         "
"33","One possible cause of the conflicting findings is changing relationships between income inequality and economic development across countries and over time. In fact, recent political economy models view the relationships between inequality and economic development as nonlinear over time and nonmonolithic across space (Acemoglu and Robinson 2000, 2002; Boix 2003, 2009; Rogowski and MacRae 2008).13 I investigate this conjecture using the random‐effects HMM.         "
"34","To measure income inequality across countries and over time, I use Leigh's (2007) adjusted top 1% income share, excluding capital gains. Many studies show that the income share of a nation’s richest population, measured from tax return data, is a highly reliable cross‐national and historical measure of inequality (Atkinson and Piketty 2007; Leigh 2007; Piketty and Saez 2006; Scheve and Stasavage 2009). I use log GDP per capita obtained from Maddison (2010) as a measure of economic development. I use a balanced panel data set tracking seven developed countries—United States, Canada, the Netherlands, France, Japan, Australia, and New Zealand—between the years 1923 and 1998.14"
"35","For the tests of time‐constant unobserved heterogeneity, I first describe a relationship between income inequality and economic development as an error‐correction process and then add random effects at the country level to capture the unobserved cross‐national heterogeneity, resulting in the random effects error‐correction model (ECM).15"
"36","Figure 1 shows country‐specific residuals from the random‐effects ECM. Visual inspection indicates that country‐specific residuals seem to have breaks around the 1940s and 1990s in most countries except New Zealand. The break test at the group level rejects the hypothesis that the residuals have no break at the group level. Also, country‐specific break tests rejected the hypothesis that unobserved factors are time constant within each country except for New Zealand.16"
"37","                Country‐Specific Residuals from the Random‐Effects Error‐Correction Model of Inequality and Economic Development"
"38","Note: The dependent variable is the top 1% income share. Included regressors are lagged top 1% share, economic growth rate, and lagged log GDP per capita. The top 1% data set is from Leigh (2007) and GDP per capita is from Maddison (2010). The model estimation was done using lme4 package in R.                     "
"39","The timings of country‐specific breaks in the country‐specific residuals are displayed in Figure 2. All countries except for New Zealand have breaks around the 1940s, and the United States is the only country with another break in the mid‐1980s. Thus, it seems reasonable to fit a random‐effects HMM with one break to investigate the shifting relationships between income inequality and economic development across countries. The resulting random‐effects ECM with the hidden regime m at t is            "
"40","                Country‐Specific Hidden Regimes in the Residuals of the Random‐Effects Error‐Correction Model of Inequality and Economic Development"
"41","Note: Large circles at the bottom indicate estimated break points and vertical bars are posterior probabilities of breaks. The data for the analysis are country‐specific residuals from the random‐effects error correction model using top 1% income share between 1923 and 1998. Included countries are Australia, Canada, New Zealand, the United States, France, Japan, and the Netherlands. The top 1% data set is from Leigh (2007) and GDP per capita is from Maddison (2010). Employed prior distributions are , , and .                     "
"42","The Bayesian model comparison of random‐effects ECMs from 0 to 4 breaks shows that the two‐break model is most reasonable with the posterior model probability of .81.17 Table 3 compares parameter estimates of the two‐break random‐effects ECM with parameter estimates of the random‐effects ECM with no break. If we compare estimates of the short‐term effect of economic growth (Growth) on top 1% income share, the random‐effects ECM reports that an additional percentage point of economic growth increases the top 1% income share by 1.80% during the twentieth century. Thus, the substantive conclusion from the constant random‐effects ECM would be that income growth always accompanies greater inequality in the economy in the history of twentieth‐century capitalist development. To gauge the substantive effect of this estimate, consider the fact that the largest annual change in the U.S. top 1% income share in the twentieth century was 2% between 1929 and 1930 (from 18.42 to 16.42). However, this pessimistic conclusion is unwarranted from the Bayesian viewpoint because the posterior probability of the zero‐break model is effectively 0.         "
"43","Countries have been exposed to various shocks during the twentieth century, and if we account for the unmodeled effects of these common shocks using HMM, we reach a very different conclusion as reported in the bottom three lines of Table 3. Most interestingly, the short‐term effect of economic growth on top 1% income share shifts dramatically across three distinct regimes. While advanced economies during the first regime (between 1942 and 1952) and the third regime (between 1987 and 1998) experienced inegalitarian economic growth with large volatility, the second regime (between 1953 and 1986) can be characterized as a period of egalitarian growth. During the second regime, an additional percentage point of economic growth does not significantly increase the top 1% income share.         "
"44","Another interesting time‐varying pattern can be found from the residual variance (). Again, the second regime is characterized as the stable relationship between the top 1% income share and economic growth. The small slopes and the small residual variance during the second regime indicate that the top 1% income share stayed very close to the intercept during these periods. Overall, the tale of inequality and economic growth from the random‐effects HMM is quite different from the one I inferred from the constant random‐effects model.         "
"45","The next example comes from the debate on whether the multilateral trade organizations have significant effects on international trade.18 Among these, I revisit a study by Goldstein, Rivers, and Tomz (2007, hereafter GRT) that finds significant effects of the GATT/WTO on bilateral trade. Most of the studies involved in this debate—including GRT—use the fixed‐effects method to control for dyad‐specific and year‐specific unobserved factors in bilateral trade data. I test the validity of the time‐constant individual effect assumption and show how the results change when I relax the assumption of time‐constant individual effects.         "
"46","It is computationally challenging to directly apply the fixed‐effects HMM to the entire data set of GRT with 17,359 dyads and 381,656 observations. Thus, I first show the results of the fixed‐effects HMM within industrial dyads (594 dyads and 28,971 observations) and then employ the OLS with dyad and regime fixed effects to the entire data set. As shown in the simulation study, results from the OLS with dyad and (correctly specified) regime fixed effects are close to the results from the fixed‐effects HMM. Dyad‐specific hidden regimes are identified by the subject‐level residual break test for all dyads with long time‐series data."
"47","The subject‐level residual break test for industrial dyads finds that 500 dyads have one (154 dyads), two (283 dyads), or three breaks (63 dyads) in their residuals among 505 dyads with longer than 20 years of time‐series observations. Figure 3 reports differences in parameter estimates between GRT (empty circles) and the fixed‐effects HMM (dark solid circles) in industrial dyads.         "
"48","                Comparison of Parameter Estimates from Different Fixed‐Effects Models (Industrial Dyads Only)"
"49","Note: The unit of observation is the directed dyad‐year. The dependent variable is the natural log of imports (in 1967 U.S. dollars). The dyad and year fixed‐effects estimates are from ordinary least squares (OLS) regression using lm function in R. GSP indicates the Generalized System of Preferences.                     "
"50","Overall, the distances between the two estimates are substantial, and some of the parameters move close to zero when I account for regime changes in individual effects using the fixed‐effects HMM. Most interestingly, when I account for country‐specific hidden regime changes in individual effects, GRT’s conclusion that industrial countries gained more from participation in the GATT/WTO than from preferential trade agreements (PTAs) seems unwarranted. Instead, the results from the fixed‐effects HMM suggest the opposite conclusion: PTAs benefit industrial countries more than the GATT/WTO."
"51","Also, while GRT report that “the GATT/WTO expanded commerce by more than 70 percent when both trading partners were industrial nations,” the fixed‐effects HMM reports a much smaller effect of 10.6%, as shown in Table 4. Similarly, the effect of GATT/WTO for “Only one participates in the GATT/WTO” shrinks by half when I control for country‐specific hidden regime changes in individual effects through the fixed‐effects HMM.         "
"52","I next discuss the results from the OLS analysis with dyad and regime fixed effects, using the entire data set to check the robustness of these findings to the inclusion of nonindustrial dyads. For this analysis, I implemented the subject‐level residual break test for 3,892 dyads with longer than 40 years of observations among all dyads. There were 2,541 dyads detected to have one break, and 1,137 dyads were detected to have two breaks. Then, I fit the OLS with dyad and regime fixed effects by demeaning the data at the regime and dyad level. The results are shown in Table 5.         "
"53","As in the case of industrial dyads, the positive effects of the GATT/WTO participation on bilateral trade significantly decrease when dyad and regime‐specific unobserved factors are removed from the analysis using the fixed‐effects method. Parameter changes in other variables (e.g., Reciprocal PTA, Nonreciprocal PTA, GDP) are rather small, as in the case of industrial dyads.19"
"54","In this article, I introduced a suite of statistical methods for diagnosing and modeling changes in unobserved heterogeneity. The findings of the simulation study and real examples both suggest that the proposed methods help to avoid invalid inferences in historical panel data analysis due to the ignorance of changes in unobserved heterogeneity. For example, the random‐effects HMM demonstrates that the pessimistic conclusion from the constant random‐effects model that income growth always increases inequality throughout the history of twentieth‐century capitalist development is unwarranted. The random‐effects HMM finds that industrialized countries commonly experienced a period of egalitarian growth between 1953 and 1986 in which an additional percentage point of economic growth did not significantly increase the top 1% income share. Also, our reanalysis of Goldstein, Rivers, and Tomz (2007) shows that the positive effects of the GATT/WTO participation on bilateral trade significantly decrease when dyad and regime‐specific unobserved factors are removed from the analysis using the fixed‐effects HMM method. In contrast to Goldstein, Rivers, and Tomz (2007), our fixed‐effects HMM showed that PTAs benefit industrial countries more than the GATT/WTO.         "
"55","Like all statistical methods using simulation, the computational cost of the proposed methods in this article is not low. For this reason, I made available software for all of the methods discussed here at MCMCpack using computationally efficient algorithms. Specifically, I used Chib and Carlin’s (1999) Algorithm 2 for efficient sampling of the random‐effects coefficients, Chib’s (1998) recursive algorithm to sample hidden states efficiently, and the Woodbury matrix identity for the efficient estimation of the variance‐covariance matrix (Woodbury 1950).20"
"56","I believe future research to develop methods for time‐varying unobserved heterogeneity beyond the linear Gaussian panel model and a simple nested panel structure will be highly benefited by taking advantage of the unified framework introduced in this article."
"57","I will briefly explain the syntax structure of the software implementation. In order to implement the methods in this article, users need to prepare the following inputs. First, subject.id and time.id are numeric indicators of group units and time units, respectively. Second, residual is a vector holding the residuals from a time‐constant panel model. y, X, and W are panel data in the form of equation (2). Note that the fixed‐effects HMM requires users to use group‐demeaned data (centered.y and centered.X). Last, m is used to denote the number of breaks. Using these inputs, users of R can implement the methods introduced in this article as follows:         "
"58","require(MCMCpack)"
"59","## 1. subject specific break test"
"60","subject.break.test <‐ testpanelSubjectBreak(subject.id, time.id, residual)"
"61","## 2. group break test using zero break, one break and two break model"
"62","group.break0 <‐ testpanelGroupBreak(subject.id, time.id, residual, m=0)"
"63","group.break1 <‐ testpanelGroupBreak(subject.id, time.id, residual, m=1)"
"64","group.break2 <‐ testpanelGroupBreak(subject.id, time.id, residual, m=2)"
"65","print(BayesFactorList(list(group.break0, group.break1, group.break2)))"
"66","## 3. Random‐effects HMMs with zero break, one break, and two breaks"
"67","RE0 <‐ HMMpanelRE(subject.id, time.id, y, X, W, m=0)"
"68","RE1 <‐ HMMpanelRE(subject.id, time.id, y, X, W, m=1)"
"69","RE2 <‐ HMMpanelRE(subject.id, time.id, y, X, W, m=2)"
"70","print(BayesFactorList(list(RE0, RE1, RE2)))"
"71","## 4. Fixed‐effects HMM using group centered data and a break list"
"72","FE <‐ HMMpanelFE(subject.id, time.id, y=centered.y, X=centered.X, m=break.list)"
"73"," "
"74","Suppose that there were exogenous shocks at  that transform unobserved individual effects . Then, the true data‐generating process is            "
"75","To show the inconsistency of random‐effects estimates, suppose that the exogenous shock at  transforms the distribution of individual effects in (8) as follows:            "
"76","Therefore, as long as , which is assumed to be true from the existence of the exogenous shock, the time‐constant random effects estimate of  is inconsistent, which leads to an inconsistent estimate of .         "
"77","Algorithm 1. Random‐Effects Hidden Markov Model"
"78","            "
"79","Sample s using Chib’s (1998) forward‐backward recursions after rewriting the random‐effects model into a multivariate time‐series model as follows:                     "
"80","Sample pkk from . pkk is the probability of staying when the state is k, and jk,k is the number of jumps from state k to k, and jk,k+1 is the number of jumps from state k to k+1.                  "
"81","Sample  from  where , , and . Xim and yim are a  matrix and a  matrix, respectively. Tm denotes the number of observations at state m for each group and K is the number of fixed‐effects covariates including the intercept.                  "
"82","Sample bim from  where  and .                  "
"83","Sample D−1m from  where  and ni is the number of groups and Tm is the number of observations at state m as defined above.                  "
"84","Sample  from  where .                  "
"85","Algorithm 2. Fixed‐Effects Hidden Markov Model"
"86","Before fitting the fixed‐effects HMM, subject‐specific break numbers Mi should be identified from the subject‐level residual break test using residuals from the fixed‐effects model.         "
"87","            "
"88","Sample  from  where  and .  where  is a vector of time‐varying intercepts for subject i.  is the centered response data for i and  is the centered model matrix without the constant term.                  "
"89","Sample si from  where .                  "
"90","Sample pik from  where ji,k is the number of jumps from state k to k and ji,k+1 is the number of jumps from state k to k+1.                  "
"91","Sample  from  where  and  by looping m from 1 to Mi+ 1. Note that , Nim is a number of observations in state m, and  is the summation over state m.                  "
"92","Sample  from  where . Nim is the number of observations at subject j’s state m.  and  are a  matrix and a  matrix, respectively.                  "
